'use client';import { useState, useEffect } from 'react';import { useRouter, useParams } from 'next/navigation';import { useNavigation } from '@/context/NavigationContext';import { useUser } from '@/context/UserContext';import { getDoctor, updateDoctor, getDoctorAvailability } from '@/lib/api';import { FaUserMd, FaSave, FaArrowLeft, FaClock } from 'react-icons/fa';import { SPALink } from '@/components/SPALink';import { toast } from 'react-toastify';export default function EditDoctorPage(props) {  const { id: propId } = props;  const { user, loading: authLoading } = useUser();  const { navigateTo } = useNavigation();  const params = useParams();  const rawId = propId || params?.id;  const doctorId = rawId ? parseIntrawId : null;  const [loading, setLoading] = useState(true);  const [formData, setFormData] = useState({    name: '', email: '', specialty: '', qualifications: '', bio: '', phone: ''  });  const [availability, setAvailability] = useState([]);  const specialties = [    'General Practitioner', 'Cardiology', 'Neurology', 'Orthopedics',    'Pediatrics', 'Dentistry', 'Psychology', 'Surgery', 'Dermatology', 'Ophthalmology'  ];  useEffect(() => {    if (user && doctorId) fetchDoctorData();  }, [user, doctorId]);  async function fetchDoctorData() {    try {      setLoading(true);      if (!doctorId) return;      const res = await getDoctor(doctorId);      const doc = res.data;      if (doc) {        setFormData({          name: doc.name || doc.user?.name || '',          email: doc.user?.email || '',          specialty: doc.specialty || '',          qualifications: doc.qualifications || '',          bio: doc.bio || '',          phone: doc.user?.phone || doc.phone || ''        });        const availRes = await getDoctorAvailability(doctorId);        setAvailability(availRes.data || []);      }    } catch (err) {      console.error('Failed to load doctor');      toast.error('Clinical record retrieval failure');    } finally {      setLoading(false);    }  }  const handleFormChange = (e) => setFormData({ ...formData, [e.target.name]: e.target.value });  async function handleSubmit(e) {    e.preventDefault();    if (!doctorId) return;    try {      await updateDoctor(doctorId, formData);      toast.success('Clinical Profile Synchronized');      navigateTo('doctors');    } catch (err) {      console.error('Failed to update doctor');      toast.error('Update committal failure');    }  }  if (authLoading || (loading && !formData.name)) return (    <div className="flex items-center justify-center p-20">      <div className="loading-spinner"></div>    </div>  );  return (    <div className="max-w-4xl mx-auto space-y-6 animate-in fade-in duration-500">      <div className="flex justify-between items-center border-b pb-4">        <div>          <h1 className="text-2xl font-bold text-gray-800">Edit specialist Profile</h1>          <p className="text-sm text-gray-500">Update medical credentials and clinical bio</p>        </div>        <button onClick={() => navigateTo('doctors')} className="btn-secondary h-10 px-4 flex items-center gap-2">           Back        </button>      </div>      <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">        <div className="lg:col-span-2 bg-white p-8 rounded-2xl shadow-sm border border-gray-200">          <form onSubmit={handleSubmit} className="space-y-6">            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">              <div className="space-y-1">                <label className="text-xs font-bold text-gray-500 uppercase tracking-wider ml-1">Full Identity</label>                <input type="text" name="name" value={formData.name} onChange={handleFormChange} required className="input-field h-12" placeholder="Dr. Jane Smith" />              </div>              <div className="space-y-1">                <label className="text-xs font-bold text-gray-500 uppercase tracking-wider ml-1">Professional Email</label>                <input type="email" name="email" value={formData.email} onChange={handleFormChange} required className="input-field h-12" placeholder="jane.smith@hospital.com" />              </div>              <div className="space-y-1">                <label className="text-xs font-bold text-gray-500 uppercase tracking-wider ml-1">Clinical Specialty</label>                <select name="specialty" value={formData.specialty} onChange={handleFormChange} required className="input-field h-12 bg-white cursor-pointer">                  {specialties.map(spec => <option key={spec} value={spec}>{spec}</option>)}                </select>              </div>              <div className="space-y-1">                <label className="text-xs font-bold text-gray-500 uppercase tracking-wider ml-1">Contact Telemetry</label>                <input type="tel" name="phone" value={formData.phone} onChange={handleFormChange} className="input-field h-12" placeholder="+1234567890" />              </div>            </div>            <div className="space-y-1">              <label className="text-xs font-bold text-gray-500 uppercase tracking-wider ml-1">Academic Qualifications</label>              <input type="text" name="qualifications" value={formData.qualifications} onChange={handleFormChange} className="input-field h-12" placeholder="MBBS, MD, PhD" />            </div>            <div className="space-y-1">              <label className="text-xs font-bold text-gray-500 uppercase tracking-wider ml-1">Professional Bio</label>              <textarea name="bio" value={formData.bio} onChange={handleFormChange} rows={4} className="w-full border rounded-xl p-4 focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 transition-all outline-none text-sm" placeholder="Detailed clinical experience and background..." />            </div>            <div className="pt-4 flex gap-4">              <button type="submit" className="flex-1 btn-primary h-14 shadow-lg shadow-primary-500/20 hover:scale-[1.01] active:scale-[0.99] transition-all">                Finalize synchronization              </button>            </div>          </form>        </div>        <div className="space-y-6">          <div className="bg-white p-6 rounded-2xl shadow-sm border border-gray-200">            <h3 className="font-bold text-gray-700 mb-6 border-b pb-3 flex items-center gap-2 text-xs uppercase tracking-widest text-primary-600">               Clinical Schedule            </h3>            {}            <div className="space-y-3 mb-8">              {availability.length > 0 ? (                availability.map((slot, i) => {                  const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];                  return (                    <div key={i} className="flex justify-between items-center bg-gray-50 px-4 py-3 rounded-xl border border-gray-100/50 group hover:border-primary-100 transition-all">                      <span className="font-bold text-[11px] text-gray-700 uppercase tracking-tighter">{days[slot.weekday]}</span>                      <span className="text-[11px] font-black text-primary-600">{slot.start_time.slice(0, 5)} - {slot.end_time.slice(0, 5)}</span>                    </div>                  );                })              ) : (                <p className="text-gray-400 text-[11px] italic text-center py-4 uppercase font-bold tracking-widest">No active shift detected</p>              )}            </div>            {}            <form              onSubmit={async (e) => {                e.preventDefault();                const form = e.target;                const slot = {                  weekday: parseInt(form.weekday.value),                  start_time: form.start.value,                  end_time: form.end.value                };                try {                  const { createAvailabilitySlot } = await import('@/lib/api');                  if (!doctorId) return;                  await createAvailabilitySlot(doctorId, slot);                  toast.success('Shift Protocol Activated');                  fetchDoctorData();                  form.reset();                } catch (err) {                  toast.error('Scheduling failure');                }              }}              className="space-y-4 pt-6 border-t border-gray-100"            >              <p className="text-[10px] font-black text-slate-400 uppercase tracking-[0.2em] mb-2">New Shift Vector</p>              <select name="weekday" className="w-full h-10 px-4 bg-slate-50 border border-slate-100 rounded-lg text-xs font-bold appearance-none cursor-pointer focus:bg-white focus:border-primary-200 outline-none">                {['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'].map((day, i) => (                  <option key={day} value={i}>{day}</option>                ))}              </select>              <div className="grid grid-cols-2 gap-3">                <input type="time" name="start" required className="h-10 px-4 bg-slate-50 border border-slate-100 rounded-lg text-xs font-bold focus:bg-white outline-none" />                <input type="time" name="end" required className="h-10 px-4 bg-slate-50 border border-slate-100 rounded-lg text-xs font-bold focus:bg-white outline-none" />              </div>              <button type="submit" className="w-full btn-primary h-10 text-[10px] uppercase font-black tracking-widest">                Add Shift              </button>            </form>          </div>        </div>      </div>    </div>  );}