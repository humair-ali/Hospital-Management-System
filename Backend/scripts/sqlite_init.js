const sqlite3 = require('sqlite3').verbose();const path = require('path');const fs = require('fs');const bcrypt = require('bcrypt');const dbPath = path.resolve(__dirname, '../../hms_hospital.db');const db = new sqlite3.Database(dbPath);console.log(`üîå Initializing SQLite DB: ${dbPath}`);const schemaPath = path.resolve(__dirname, '../migrations/schema_sqlite.sql');const schema = fs.readFileSync(schemaPath, 'utf8');const runScript = (script) => {    return new Promise((resolve, reject) => {        db.exec(script, (err) => {            if (err) reject(err);            else resolve();        });    });};async function init() {    try {        console.log('Applying schema...');        await runScript(schema);        console.log('‚úÖ Schema applied.');        console.log('Seeding Roles...');        const roles = [            { name: 'admin', description: 'System administrator' },            { name: 'doctor', description: 'Medical doctor' },            { name: 'nurse', description: 'Nurse' },            { name: 'receptionist', description: 'Front desk' },            { name: 'accountant', description: 'Billing' },            { name: 'patient', description: 'Patient' }        ];        for (const role of roles) {            await new Promise((resolve) => {                db.run("INSERT OR IGNORE INTO roles (name, description) VALUES (?, ?)", [role.name, role.description], resolve);            });        }        console.log('Seeding Admin...');        const adminEmail = 'admin@hospital.com';        const hashedPassword = await bcrypt.hash('admin123', 10);        db.get("SELECT id FROM roles WHERE name = 'admin'", (err, row) => {            if (row) {                db.run(`                    INSERT INTO users (role_id, name, email, password, phone)                     SELECT ?, 'System Admin', ?, ?, '000-000-0000'                    WHERE NOT EXISTS(SELECT 1 FROM users WHERE email = ?)                 `, [row.id, adminEmail, hashedPassword, adminEmail], (err) => {                    if (err) console.error('Error inserting admin:', err);                    else console.log('‚úÖ Admin user ensured.');                    process.exit(0);                });            } else {                console.error('‚ùå Admin role not found!');                process.exit(1);            }        });    } catch (err) {        console.error('‚ùå Init failed:', err);        process.exit(1);    }}init();